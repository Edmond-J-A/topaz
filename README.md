# topaz
Mo crystal 用户系统

**topaz pull user process**:

游戏服务器（以下简称 GS），Topaz 服务器（以下简称 TS）

在拉取用户前，GS 需要准备公钥和私钥，并且手动将公钥在 TS 处注册为可信服务器。

每当拉取用户时，GS 向 TS 发送 1 个 HTTP 请求，请求体为 Form Data。

```js
Server: [GS 的名字，需要和 TS 中的公钥相对应]
UserId: [需要拉取的用户 id]
Password: [可选项，若置空则不返回敏感信息。已在前端通过 md5 编码]
Signature: [将上述所有字段的键和值以字符串拼接，再用密钥对其进行签名]
```

TS 收到此请求，会通过 GS 公钥验证 Server 字段的真实性。若签名非法，则返回错误码。若签名验证通过，则：

1. 若有密码：则验证密码。若密码正确，则返回除密码外的所有信息；若密码错误，则返回错误码

2. 若无密码：返回用户基本信息（不包含敏感信息）